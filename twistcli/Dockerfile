FROM ubuntu:latest

# Update and install packages in one layer, and clean up afterwards
RUN apt update -y && \
    apt install -y sudo python3 python3-pip git curl wget node-hawk node-minimist && \
    apt clean && \
    rm -rf /var/lib/apt/lists/*

# Install AWS CLI and Boto3
#RUN pip3 --no-cache-dir install --upgrade awscli boto3


# Make sure twistcli is executable

# Copy twistcli to the appropriate directory

RUN curl --progress-bar -L --header "authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoibHl0QHUtaW5mcmEuY29tIiwicm9sZSI6ImFkbWluIiwicm9sZVBlcm1zIjpbWzI1NSwyNTUsMjU1LDI1NSwyNTUsOTVdLFsyNTUsMjU1LDI1NSwyNTUsMjU1LDk1XV0sInNlc3Npb25UaW1lb3V0U2VjIjo2MDAsInNhYXNUb2tlbiI6ImV5SmhiR2NpT2lKSVV6STFOaUo5LmV5SnpkV0lpT2lKc2VYUkFkUzFwYm1aeVlTNWpiMjBpTENKelpYSjJhV05sVlhOaFoyVlBibXg1SWpwMGNuVmxMQ0ptYVhKemRFeHZaMmx1SWpwbVlXeHpaU3dpY0hKcGMyMWhTV1FpT2lJeE1qQXdNelF4TlRFeE5URTBPVEU1T1RNMklpd2lhWEJCWkdSeVpYTnpJam9pTXpVdU1qQXdMakV5TXk0eU16WWlMQ0pwYzNNaU9pSm9kSFJ3Y3pvdkwyRndhUzVxY0M1d2NtbHpiV0ZqYkc5MVpDNXBieUlzSW5KbGMzUnlhV04wSWpvd0xDSjFjMlZ5VW05c1pWUjVjR1ZFWlhSaGFXeHpJanA3SW1oaGMwOXViSGxTWldGa1FXTmpaWE56SWpwbVlXeHpaWDBzSW5WelpYSlNiMnhsVkhsd1pVNWhiV1VpT2lKVGVYTjBaVzBnUVdSdGFXNGlMQ0pwYzFOVFQxTmxjM05wYjI0aU9tWmhiSE5sTENKc1lYTjBURzluYVc1VWFXMWxJam94TnpJNU5UZ3dNRFUyTmpVNUxDSmhkV1FpT2lKb2RIUndjem92TDJGd2FTNXFjQzV3Y21semJXRmpiRzkxWkM1cGJ5SXNJblZ6WlhKU2IyeGxWSGx3WlVsa0lqb3hMQ0poZFhSb0xXMWxkR2h2WkNJNklsQkJUbDlUUVUxTU1pSXNJbk5sYkdWamRHVmtRM1Z6ZEc5dFpYSk9ZVzFsSWpvaVZTMUpibVp5WVNCRGJ5NHNJRXgwWkM0Z0xTQXpOamN5TVRVeE16QTROVFV4TVRFek5UY3dJaXdpYzJWemMybHZibFJwYldWdmRYUWlPall3TENKMWMyVnlVbTlzWlVsa0lqb2lZMlU1TTJJMU5USXRPVFl6TkMwMFptRTFMVGd6TlRndE5XSXdNMlptT0dOaVlqTTFJaXdpYUdGelJHVm1aVzVrWlhKUVpYSnRhWE56YVc5dWN5STZkSEoxWlN3aVpYaHdJam94TnpJNU5UZ3dOall3TENKcFlYUWlPakUzTWprMU9EQXdOakFzSW5WelpYSnVZVzFsSWpvaWJIbDBRSFV0YVc1bWNtRXVZMjl0SWl3aWRYTmxjbEp2YkdWT1lXMWxJam9pVTNsemRHVnRJRUZrYldsdUluMC5Ec0J0TnlTRGpFbldJR2g4VkFXY0txQUZaUGRFS0lWbVo2VHdjVnFVMV9JIiwiaXNzIjoidHdpc3Rsb2NrIiwiZXhwIjoxNzI5NTgzNjYwfQ.4EUrV-hHH8zpxYevgMZF0dw1M6DNNeAY97siltITlz0" https://asia-northeast1.cloud.twistlock.com/japan-1167212692/api/v1/util/twistcli > twistcli; chmod a+x twistcli;

COPY ./twistcli /usr/local/bin/
RUN chmod +x /usr/local/bin/twistcli

# Set entrypoint
ENTRYPOINT ["twistcli"]
